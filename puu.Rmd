Edellä (taulukko) esitimme tavan ryhmitellä asumisesta kertovat tekstikappaleet
sen mukaan, miten kirjoittaja toteuttaa siirtymän uuteen aiheeseen. Seuraavassa
sovellamme laadullisen analyysin tuloksena saatuun ryhmäjakoon tilastollisia
menetelmiä, tarkemmin ottaen ehdollisia päätöksentekopuita (conditional
inference trees). 

Ehdollisissa päätöksentekopuissa  ajatuksena on, että
[@levshina2015, x] . Analyysissa määritellään yksi selitettävä muuttuja [vrt. @ketokivi2015, x]
ja (tavallisesti useita) selittäviä muuttujia, joiden avulla jonkin tapauksen
päätymistä johonkin luokkaan pyritään ennustamaan. Nyt käsillä olevassa tutkimuksessa
selitettävän muuttujan muodostavat laadullisen analyysin tuloksena
luodut topiikin asetustapojen `r length(unique(analysoitu_otanta$group))`
ryhmää. Yksittäisen matkakertomuksen päätymistä johonkin näistä ryhmistä
on suorittamassamme luokittelupuuanalyysissä tarkasteltu seuraavien selittävien
muuttujien avulla.[^tark]

[^tark](mieti, linkki githubiin ja vähennä selitystä)


1. *Koneellisen jäsentimen topiikki-indikaattorille asettama syntaktinen rooli*.
   Taulukossa `r Ref('tab', 'tt_deproles')` esiteltyjä kategorioita
   lavennettiin siten, että arvot *nsubj* ja
   *nsubj:cop* yhdistettiin yhdeksi subjektin kategoriaksi (*subj*) ja arvot *nmod:poss*
   sekä *nmod:gobj* yhdeksi *nmod:x*-kategoriaksi, jolla viitattiin kaikkiin 
   kompleksisiin nominaalirakenteisiin (*asunnon hankinta*, *asumisen järjestäminen*).
2.  *Topiikki-indikaattorin sijainti virkkeessä* jakaa aineiston
    kahteen luokkaan: tapauksiin, joissa topiikki-indikaattori on koko virkkeen
    ensimmäisenä ja muihin tapauksiin.
3. Myös *lauseen predikaattiverbin persoona*  jaettiin kahteen kategoriaan:
   tapauksiin, joissa predikaattiverbi on ensimmäisessä persoonassa ja muihin tapauksiin.
4. *Side muuhun tekstiin* -muuttujalla on kolme kategoriaa: tapaukset, joissa
   asumistopiikkia on pohjustettu jo edellisessä kappaleessa muttei niin selvästi, että 
   kyseessä olisi linkkitapaus (*edel.*); tapaukset, joissa topiikki asetetaan viittaamalla
   selkeästi johonkin edellä muodostettuun linkkiin (*linkki*); tapaukset, joissa asumiskappaletta
   edeltää väliotsikko (*ots*) sekä tapaukset, joissa mitään edellä kuvatuista siteistä ei ole (*x*).
5. *Topiikki-indikaattorin morfologinen rakenne*  erottelee toisistaan finiittiverbit,
   infintiivimuodot (mukaan lukien minen-johdokset) ja substantiivit.
6. *Aikamuoto*-muuttuja pitää sisällään arvot *preesens*, *imperfekti*,
   *pluskvamperfekti/perferkti*[^perft] ja *ellipsi* (--).

[^perft]: Perfektitapauksia aineistossa oli vain yksi ja sekin
konditionaalissa, joten molemmat suomen liittoaikamuodot yhdistettiin samaan
kategoriaan.

Näiden muuttujien perusteella rakennettiin päätöksentekopuu R-ohjelmiston
*party*-kirjastoon kuuluvaa *ctree*-funktiota [@party] käyttäen. 
Analyysin tulos on esitetty kuviossa `r Ref('fig', 'ff_tree')`.

```{r, echo=FALSE, out.extra='angle=90', fig.width=14,fig.height=10,fig.cap=Ref('fig','ff_tree','Topiikkia asettavien ryhmien rakenne luokittelupuun avulla tarkasteltuna')}

library(party)
set.seed(204)
stats <- FormatForStatisticalAnalysis(T,F)
stats$side <- as.character(stats$side)
stats$side[stats$side=="otsikko"] <- "ots."
stats$side[stats$side=="edellinen"] <- "ed."
stats$side <- as.factor(stats$side)
puu <- ctree(group ~ side + location + dep + pers + pos + tense,stats)
plot(puu,         
  inner_panel=node_inner(puu,
       abbreviate = FALSE,            
       pval = T, 
       id = T),
     terminal_panel=node_barplot(puu,id=T,beside=T,ylines=1.2,gap=0,ymax=1))

```

Kuviossa `r Ref('fig', 'ff_tree')` tutkimusaineisto
on jaettu kymmeneen ryhmään (kuvion alimmalla rivillä esitetyt
pylväskaaviot) edellä kuvattujen selittävien muuttujien perusteella.
Kuvio esittää selittävien muuttujien vaikutuksen 
sarjana päätöksiä (kuvion ympyränmuotoiset noodit), jotka on numeroitu
yhdestä 19:ään, esimerkiksi: *jos jonkin tapauksen dependenssirooli
on predikaatti (noodi 1) ja pääverbin persoona ensimmäinen (noodi 15) ja jos lisäksi
tapausta ei edellä väliotsikko, kyseessä on aina ryhmään 2
kuuluva tapaus (noodi 18)*. Jos taas dependenssirooli on predikaatti (noodi 1),
joka ei kuitenkaan esiinny ensimmäisessä persoonassa, on kyseessä useimmiten
ryhmän 13 tapaus, vaikka muutkin vaihtoehdot ovat mahdollisia.
Jokaisen noodin kohdalle on myös merkitty p-arvo (tästä tarkemmin).


Oleellista tässä esitetyssä päätöksentekopuussa on, että vaikka itse luokittelu
ryhmiin tehtiin puhtaasti artikkelin kirjoittajien tulkinnan perusteella ja
kustakin ryhmästä annettiin edellä funktionaalinen kuvaus, on ryhmiä
mahdollista kuvailla melko pitkälle myös rakenteellisten ominaisuuksien
valossa. Karkeasti ottaen voidaan todeta, että suurin osa laadullisen analyysin
tuloksena laadituista kolmestatoista ryhmästä  pystytään päättelemään
hyödyntämällä kolmea[^sijaintihom] yksinkertaista rakenteellisen mikrotason muuttujaa:
verbin persoonaa, aikamuotoa ja indikaattorisanan dependenssiroolia.
Taulukossa `r Ref('tab', 'tt_ryhmatpuusta')` on tiivistetty
näiden muuttujien vaikutus topiikkia asettavan virkkeen päätymiseen
johonkin laadullisessa analyysissa määritellyistä ryhmistä. 

[^sijaintihom]: Päätöksentekopuun tuottaneessa algoritmissa indikaattorin sijainti osoittautui
hieman yllättäenkin merkityksettömäksi.

```{r, echo=FALSE, results="asis"}
library(pander)

gft <- read.csv(system.file("extdata", "groups_from_tree.csv", package="SataTapaa"),sep="\t")
gft[,1] <- as.factor(gft[,1])
tab <- t(as.matrix(rbind(apply(gft,1,function(x)ifelse(x=="--",x,paste0("*",x,"*"))))))
for(i in c(4,5)){
    tab[,i] <- gsub("\\*","",tab[,i])
}
colnames(tab) <- sapply(names(gft),function(x)gsub("\\."," ",x))
pander(tab, caption=Ref('tab','tt_ryhmatpuusta','Kvantitatiivisesti pääteltävissä olevat ryhmät'))

```


Taulukon mukaan ryhmä 1 voidaan rakenteiden tasolla määritellä siten, että
siinä on nominaalinen topiikki-indikaattori, jonka pääverbi esiintyy ensimmäisessä
persoonassa ja imperfektissä. Ryhmän `r which(print.labels=="@ee_omakokemus")` puolestaan erottaa 
muista se, että asumisaiheeseen viitataan siinä jollakin kompleksisella
lausekkeella, kuten *asunnon hankinta* tai *asumisen järjestäminen*. Ryhmä 
`r which(print.labels=="@ee_ennakoivat")` taas voidaan määritellä ennen kaikkea aikamuodon pohjalta: siihen 
kuuluvat tapaukset, joissa verbi on pluskvamperfektissä.
Ainoastaan ryhmien `r which(print.labels=="@ee_narratiivi")`, `r which(print.labels=="@ee_parisanaa")` ja
`r which(print.labels=="@ee_valimaasto")`  osalta ei tässä esitetyn
päätöksentekopuun perusteella voida esittää selkeitä piirteitä, jotka johtaisivat
tapauksen sijoittamiseen juuri näihin ryhmiin. Lisäksi on huomattava,
että esimerkin sijoittaminen ryhmään `r which(print.labels=="@ee_linkki")` on perustunut täysin 
artikkelin kirjoittajien tulkintaan: se, että tulevaa topiikkia
on eksplisiittisesti pohjustettu aiemmassa tekstissä, ei ole pääteltävissä
siitä, minkälaisia rakenteita topiikkia asettavassa virkkeessä
on käytetty.


Päätelmäluvun puolelle se, miä tästä kaikesta seuraa.
